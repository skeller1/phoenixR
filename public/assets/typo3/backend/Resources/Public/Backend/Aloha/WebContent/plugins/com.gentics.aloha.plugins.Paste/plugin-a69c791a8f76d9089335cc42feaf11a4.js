/*!
* Aloha Editor
* Author & Copyright (c) 2010 Gentics Software GmbH
* aloha-sales@gentics.com
* Licensed unter the terms of http://www.aloha-editor.com/license.html
*/
/**
 * Register the PastePlugin as GENTICS.Aloha.Plugin
 */
GENTICS.Aloha.PastePlugin=new GENTICS.Aloha.Plugin("com.gentics.aloha.plugins.Paste"),GENTICS.Aloha.PastePlugin.pasteHandlers=[],GENTICS.Aloha.PastePlugin.init=function(){var a=this;this.pasteDiv=jQuery('<div style="position:absolute; top:-100000px; left:-100000px"></div>'),this.pasteDiv.attr("contentEditable","true"),jQuery("body").append(this.pasteDiv),GENTICS.Aloha.EventRegistry.subscribe(GENTICS.Aloha,"editableCreated",function(b,c){jQuery.browser.msie?c.obj.bind("beforepaste",function(b){a.redirectPaste(),b.stopPropagation()}):c.obj.bind("paste",function(b){a.redirectPaste(),window.setTimeout(function(){a.getPastedContent()},10),b.stopPropagation()})}),jQuery.browser.msie&&this.pasteDiv.bind("paste",function(b){window.setTimeout(function(){a.getPastedContent()},10)})},GENTICS.Aloha.PastePlugin.redirectPaste=function(){this.currentRange=new GENTICS.Utils.RangeObject(!0),this.currentEditable=GENTICS.Aloha.activeEditable,this.pasteDiv.text(""),this.currentEditable&&this.currentEditable.blur(),GENTICS.Utils.Dom.setCursorInto(this.pasteDiv.get(0)),this.pasteDiv.focus()},GENTICS.Aloha.PastePlugin.getPastedContent=function(){var a=this;for(var b=0;b<this.pasteHandlers.length;++b)this.pasteHandlers[b].handlePaste(this.pasteDiv);if(this.currentRange&&this.currentEditable){var c=this.pasteDiv.contents();for(var b=c.length-1;b>=0;--b)GENTICS.Utils.Dom.insertIntoDOM(jQuery(c.get(b)),a.currentRange,a.currentEditable.obj,!1);this.currentEditable.activate(),this.currentEditable.obj.focus(),c.length>0?GENTICS.Utils.Dom.setCursorAfter(c.get(c.length-1)):this.currentRange.select()}this.currentRange=!1,this.currentEditable=!1,this.pasteDiv.text("")},GENTICS.Aloha.PastePlugin.register=function(a){this.pasteHandlers.push(a)},GENTICS.Aloha.PastePlugin.PasteHandler=function(){GENTICS.Aloha.PastePlugin.register(this)},GENTICS.Aloha.PastePlugin.PasteHandler.prototype.handlePaste=function(a){}